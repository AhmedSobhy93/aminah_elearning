
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns="http://www.w3.org/1999/html"
      layout:decorate="~{layout/base}">
<head>
    <title>Users</title>
</head>
<body>
<section layout:fragment="content">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary fw-bold">Manage Users</h2>

        <a th:href="@{/admin/users/new}" class="btn btn-primary btn-md">
            <i class="bi bi-person-plus"></i> Add User
        </a>
    </div>

    <div class="card p-3 shadow-sm">

        <div class="table-responsive">
            <table class="table table-hover table-bordered align-middle aminah-table">
                <thead class="table-light">
                <tr>
                    <th>#</th>
                    <th>Username</th>
                    <th>Full Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th class="text-center">Actions</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="u, iterStat : ${users}">
                    <td th:text="${iterStat.index + 1}"></td>
                    <td th:text="${u.username}"></td>
                    <td th:text="${u.fullName}"></td>
                    <td th:text="${u.email}"></td>

                    <td>
                            <span class="badge bg-aminah text-white"
                                  th:text="${u.role}">
                            </span>
                    </td>

                    <td>
                            <span th:class="${u.enabled} ? 'badge bg-success' : 'badge bg-danger'"
                                  th:text="${u.enabled ? 'Active' : 'Inactive'}"></span>
                    </td>

                    <td class="text-center">
                        <a th:href="@{'/admin/users/' + ${u.id}}"
                           class="btn btn-primary btn-md me-1 mb-1" title="View">View<i class="bi bi-eye"></i></a>

                        <a th:href="@{'/admin/users/edit/' + ${u.id}}"
                           class="btn btn-warning btn-md me-1 mb-1" title="Edit">Edit<i class="bi bi-pencil"></i></a>

                        <a th:href="@{'/admin/users/delete/' + ${u.id}}"
                           onclick="return confirm('Are you sure?')"
                           class="btn btn-danger btn-md me-1 mb-1" title="Delete">Delete<i class="bi bi-trash"></i></a>

                        <a th:if="${!u.enabled}"
                           th:href="@{'/admin/users/enable/' + ${u.id}}"
                           class="btn btn-success btn-md me-1 mb-1" title="Enable">Enable<i class="bi bi-check-circle"></i></a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <nav th:if="${totalPages > 1}" aria-label="Page navigation" class="mt-3">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
                    <a class="page-link" th:href="@{|/admin/users?page=${currentPage-1}|}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPages)}"
                    th:classappend="${i == currentPage} ? 'active'">
                    <a class="page-link" th:href="@{|/admin/users?page=${i}|}" th:text="${i}">1</a>
                </li>

                <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
                    <a class="page-link" th:href="@{|/admin/users?page=${currentPage+1}|}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>

    </div>

</section>
</body>
</html>
